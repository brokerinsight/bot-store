<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Virus - Deriv Bot Store</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body:has(#login-modal:not(.hidden)) > *:not(#login-modal) {
      filter: blur(5px);
    }
  </style>
</head>
<body class="bg-gray-100">
  <nav class="bg-white shadow-md sticky top-0 z-20">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex items-center">
          <h1 class="text-xl font-bold text-gray-800">Admin Panel</h1>
          <div class="ml-6 flex space-x-4 sm:space-x-8">
            <a href="#add-bot" class="nav-link text-gray-500 hover:text-gray-900 inline-flex items-center px-1 pt-1 text-sm font-medium border-b-2 border-green-500">Add Bot</a>
            <a href="#manage-bots" class="nav-link text-gray-500 hover:text-gray-900 inline-flex items-center px-1 pt-1 text-sm font-medium">Manage Bots</a>
            <a href="#settings" class="nav-link text-gray-500 hover:text-gray-900 inline-flex items-center px-1 pt-1 text-sm font-medium">Settings</a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <section id="add-bot" class="section bg-white rounded-lg shadow-md p-6 mb-8">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Add New Bot</h2>
      <form id="product-form">
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="name" class="block text-sm font-medium text-gray-700">Name</label>
            <input type="text" id="name" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="price" class="block text-sm font-medium text-gray-700">Price ($)</label>
            <input type="number" id="price" step="0.01" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div class="sm:col-span-2">
            <label for="desc" class="block text-sm font-medium text-gray-700">Description</label>
            <textarea id="desc" required class="mt-1 w-full p-2 border border-gray-300 rounded-md"></textarea>
          </div>
          <div class="sm:col-span-2">
            <label for="embed" class="block text-sm font-medium text-gray-700">Embed Link (Optional, e.g., YouTube)</label>
            <input type="url" id="embed" class="mt-1 w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., https://www.youtube.com/embed/VIDEO_ID">
          </div>
          <div>
            <label for="category" class="block text-sm font-medium text-gray-700">Category</label>
            <select id="category" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
            </select>
          </div>
          <div>
            <label for="item" class="block text-sm font-medium text-gray-700">Item ID</label>
            <input type="text" id="item" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div class="sm:col-span-2">
            <label for="img" class="block text-sm font-medium text-gray-700">Image URL</label>
            <input type="url" id="img" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div class="sm:col-span-2">
            <label class="flex items-center">
              <input type="checkbox" id="isNew" class="mr-2">
              <span class="text-sm font-medium text-gray-700">Mark as New</span>
            </label>
          </div>
        </div>
        <button type="submit" class="mt-6 w-full bg-green-600 text-white py-2 rounded-md hover:bg-green-700">Add Product</button>
      </form>
    </section>

    <section id="manage-bots" class="section bg-white rounded-lg shadow-md p-6 mb-8 hidden">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Manage Bots</h2>
      <ul id="bot-list" class="space-y-4">
      </ul>
    </section>

    <section id="settings" class="section bg-white rounded-lg shadow-md p-6 hidden">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Settings</h2>
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Manage Categories</h3>
        <div class="flex gap-4 mb-4">
          <input type="text" id="new-category" class="w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., Volatility Bots">
          <button id="add-category" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Add Category</button>
        </div>
        <ul id="category-list" class="space-y-2">
        </ul>
      </div>
      <div class="mb-6">
        <label class="flex items-center">
          <input type="checkbox" id="urgent-toggle" class="mr-2">
          <span class="text-sm font-medium text-gray-700">Show Urgent Message on Store</span>
        </label>
        <textarea id="urgent-message" class="mt-2 w-full p-2 border border-gray-300 rounded-md" placeholder="Enter urgent message..."></textarea>
        <button id="save-urgent" class="mt-2 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Save Message</button>
      </div>
      <div class="mb-6">
        <label for="support-email" class="block text-sm font-medium text-gray-700">Support Email</label>
        <input type="email" id="support-email" class="mt-1 w-full p-2 border border-gray-300 rounded-md" value="support@derivbotstore.com">
        <button id="save-email" class="mt-2 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Save Email</button>
      </div>
      <div class="mb-6">
        <label for="copyright-text" class="block text-sm font-medium text-gray-700">Footer Copyright Text</label>
        <input type="text" id="copyright-text" class="mt-1 w-full p-2 border border-gray-300 rounded-md" value="© 2025 Deriv Bot Store. All rights reserved.">
        <button id="save-copyright" class="mt-2 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Save Copyright</button>
      </div>
      <div class="mb-6">
        <label for="logo-url" class="block text-sm font-medium text-gray-700">Logo URL (for Navbar)</label>
        <input type="url" id="logo-url" class="mt-1 w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., https://via.placeholder.com/150">
        <button id="save-logo" class="mt-2 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Save Logo</button>
      </div>
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Social Media Links</h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="tiktok" class="block text-sm font-medium text-gray-700">TikTok</label>
            <input type="url" id="tiktok" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="whatsapp" class="block text-sm font-medium text-gray-700">WhatsApp</label>
            <input type="url" id="whatsapp" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="call" class="block text-sm font-medium text-gray-700">Call</label>
            <input type="tel" id="call" class="mt-1 w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., tel:+1234567890">
          </div>
          <div>
            <label for="instagram" class="block text-sm font-medium text-gray-700">Instagram</label>
            <input type="url" id="instagram" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="x" class="block text-sm font-medium text-gray-700">X</label>
            <input type="url" id="x" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="facebook" class="block text-sm font-medium text-gray-700">Facebook</label>
            <input type="url" id="facebook" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="youtube" class="block text-sm font-medium text-gray-700">YouTube</label>
            <input type="url" id="youtube" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
        </div>
        <button id="save-socials" class="mt-4 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Save Socials</button>
      </div>
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Payment Gateway</h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="payment-name" class="block text-sm font-medium text-gray-700">Payment Gateway Name</label>
            <input type="text" id="payment-name" class="mt-1 w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., Crypto">
          </div>
          <div>
            <label for="payment-url" class="block text-sm font-medium text-gray-700">Payment Gateway URL</label>
            <input type="url" id="payment-url" class="mt-1 w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., https://crypto-payment.com">
          </div>
        </div>
        <button id="save-payment" class="mt-4 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Save Payment Gateway</button>
      </div>
      <div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Change Admin Password</h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="new-password" class="block text-sm font-medium text-gray-700">New Password</label>
            <input type="password" id="new-password" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="confirm-password" class="block text-sm font-medium text-gray-700">Confirm Password</label>
            <input type="password" id="confirm-password" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
        </div>
        <button id="change-password" class="mt-4 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Change Password</button>
      </div>
    </section>
  </main>

  <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg p-6 max-w-sm w-full">
      <h3 class="text-xl font-bold text-gray-900 mb-4">Admin Login</h3>
      <div class="mb-4">
        <label for="login-email" class="block text-sm font-medium text-gray-700">Email</label>
        <input type="email" id="login-email" class="mt-1 w-full p-2 border border-gray-300 rounded-md" required>
      </div>
      <div class="mb-4 relative">
        <label for="login-password" class="block text-sm font-medium text-gray-700">Password</label>
        <input type="password" id="login-password" class="mt-1 w-full p-2 border border-gray-300 rounded-md" required>
        <button type="button" id="toggle-password" class="absolute right-2 top-9 text-gray-500">Show</button>
      </div>
      <button id="login-submit" class="w-full bg-green-600 text-white py-2 rounded-md hover:bg-green-700">Login</button>
    </div>
  </div>

  <script>
    let GITHUB_TOKEN = null;
    const REPO_OWNER = "brokerinsight";
    const REPO_NAME = "bot-store";
    const FILE_PATH = "data.json";
    const BRANCH = "main";
    let tokenFetchFailed = false;

    let products = [];
    let categories = [];
    let settings = {};

    async function fetchGitHubToken() {
      try {
        const response = await fetch("/api/get-token");
        const data = await response.json();
        if (data.token) {
          GITHUB_TOKEN = data.token;
          tokenFetchFailed = false;
        } else {
          throw new Error("GitHub token not found");
        }
      } catch (error) {
        console.error("Error fetching GitHub token:", error);
        tokenFetchFailed = true;
      }
    }

    async function fetchData() {
      try {
        if (!GITHUB_TOKEN && !tokenFetchFailed) {
          await fetchGitHubToken();
        }

        let response;
        if (GITHUB_TOKEN && !tokenFetchFailed) {
          response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/${FILE_PATH}?ref=${BRANCH}`, {
            headers: {
              Authorization: `token ${GITHUB_TOKEN}`,
              Accept: "application/vnd.github.v3+json"
            }
          });
        } else {
          response = await fetch(`https://raw.githubusercontent.com/${REPO_OWNER}/${REPO_NAME}/${BRANCH}/${FILE_PATH}`, {
            cache: "no-store"
          });
        }

        if (!response.ok) {
          throw new Error(`Failed to fetch data: ${response.status} ${response.statusText}`);
        }

        const data = await response.json();
        const content = GITHUB_TOKEN && !tokenFetchFailed ? JSON.parse(atob(data.content)) : data;
        products = content.products || [];
        categories = content.categories || ["Digit Bots", "Over/Under", "Rise/Fall"];
        settings = content.settings || {
          adminEmail: "martinke444@gmail.com",
          adminPassword: "#0719529802#0710160851#Pn",
          supportEmail: "support@derivbotstore.com",
          copyrightText: "© 2025 Deriv Bot Store. All rights reserved.",
          logoUrl: "",
          socials: { tiktok: "", whatsapp: "", call: "", instagram: "", x: "", facebook: "", youtube: "" },
          urgentMessage: { enabled: false, text: "" },
          paymentGateway: { name: "", url: "https://kaylie-payment-site.vercel.app/" }
        };
      } catch (error) {
        console.error("Error fetching data:", error);
        alert("Failed to load data from GitHub. Please check the console for details.");
      }
    }

    // Function to handle button loading state
    function setButtonLoading(button, isLoading) {
      if (isLoading) {
        button.disabled = true;
        button.textContent = "Saving...";
      } else {
        button.disabled = false;
        button.textContent = button.dataset.originalText || button.textContent;
      }
    }

    async function saveData(maxRetries = 3) {
      if (!GITHUB_TOKEN) {
        await fetchGitHubToken();
      }

      if (!GITHUB_TOKEN || tokenFetchFailed) {
        alert("Cannot save data: GitHub token unavailable. Please try again later.");
        return false;
      }

      let retries = 0;
      while (retries < maxRetries) {
        try {
          const fetchResponse = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/${FILE_PATH}?ref=${BRANCH}`, {
            headers: {
              Authorization: `token ${GITHUB_TOKEN}`,
              Accept: "application/vnd.github.v3+json"
            }
          });
          if (!fetchResponse.ok) {
            throw new Error(`Failed to fetch file SHA: ${fetchResponse.status} ${fetchResponse.statusText}`);
          }
          const fileData = await fetchResponse.json();
          const sha = fileData.sha;

          const updatedData = {
            products,
            categories,
            settings
          };
          const jsonString = JSON.stringify(updatedData, null, 2);
          const encodedString = unescape(encodeURIComponent(jsonString));
          const content = btoa(encodedString);

          const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/${FILE_PATH}`, {
            method: "PUT",
            headers: {
              Authorization: `token ${GITHUB_TOKEN}`,
              Accept: "application/vnd.github.v3+json"
            },
            body: JSON.stringify({
              message: "Updated data.json from admin panel",
              content: content,
              sha: sha,
              branch: BRANCH
            })
          });

          if (response.ok) {
            console.log("Data saved to GitHub successfully!");
            return true;
          } else if (response.status === 409) {
            retries++;
            console.warn(`SHA conflict detected, retrying (${retries}/${maxRetries})...`);
            continue;
          } else {
            const errorData = await response.json();
            throw new Error(`Failed to save data to GitHub: ${response.status} ${response.statusText} - ${JSON.stringify(errorData)}`);
          }
        } catch (error) {
          console.error("Error saving data:", error);
          if (retries === maxRetries - 1) {
            alert(`Failed to save data to GitHub after ${maxRetries} attempts. Error: ${error.message}. Please check the console for details.`);
            return false;
          }
          retries++;
        }
      }
      return false;
    }

    const loginModal = document.getElementById("login-modal");
    const loginPassword = document.getElementById("login-password");
    const togglePassword = document.getElementById("toggle-password");
    togglePassword.addEventListener("click", () => {
      const type = loginPassword.type === "password" ? "text" : "password";
      loginPassword.type = type;
      togglePassword.textContent = type === "password" ? "Show" : "Hide";
    });
    document.getElementById("login-submit").addEventListener("click", async () => {
      const email = document.getElementById("login-email").value;
      const password = document.getElementById("login-password").value;
      if (email === settings.adminEmail && password === settings.adminPassword) {
        loginModal.classList.add("hidden");
      } else {
        alert("Invalid email or password!");
      }
    });

    const sections = document.querySelectorAll(".section");
    document.querySelectorAll(".nav-link").forEach(link => {
      link.addEventListener("click", (e) => {
        e.preventDefault();
        const target = link.getAttribute("href").substring(1);
        sections.forEach(section => section.classList.add("hidden"));
        document.getElementById(target).classList.remove("hidden");
        document.querySelectorAll(".nav-link").forEach(l => l.classList.remove("border-b-2", "border-green-500"));
        link.classList.add("border-b-2", "border-green-500");
      });
    });

    function renderCategories() {
      const select = document.getElementById("category");
      select.innerHTML = "";
      categories.forEach(cat => {
        const option = document.createElement("option");
        option.value = cat;
        option.textContent = cat;
        select.appendChild(option);
      });
    }

    function renderCategoryList() {
      const categoryList = document.getElementById("category-list");
      categoryList.innerHTML = categories.map((cat, index) => `
        <li class="flex justify-between items-center p-2 bg-gray-50 rounded">
          <span>${cat}</span>
          <button onclick="deleteCategory(${index})" class="text-red-600 hover:text-red-800">Delete</button>
        </li>
      `).join("");
    }

    document.getElementById("add-category").addEventListener("click", async (e) => {
      const button = e.target;
      setButtonLoading(button, true);
      const newCat = document.getElementById("new-category").value.trim();
      if (newCat && !categories.includes(newCat)) {
        categories.push(newCat);
        const success = await saveData();
        if (success) {
          renderCategories();
          renderCategoryList();
          document.getElementById("new-category").value = "";
          alert("Category added and synced to GitHub!");
        }
      } else if (!newCat) {
        alert("Please enter a category name!");
      } else {
        alert("Category already exists!");
      }
      setButtonLoading(button, false);
    });

    async function deleteCategory(index) {
      if (confirm("Are you sure you want to delete this category? Bots in this category will remain but won't be visible until reassigned.")) {
        categories.splice(index, 1);
        const success = await saveData();
        if (success) {
          renderCategories();
          renderCategoryList();
          alert("Category deleted and synced to GitHub!");
        }
      }
    }

    function renderBots() {
      const botList = document.getElementById("bot-list");
      botList.innerHTML = products.map((product, index) => `
        <li class="p-4 bg-gray-50 rounded flex justify-between items-center">
          <div>
            <span class="font-semibold">${product.name}</span> - $${product.price} (${product.category})
            ${product.isArchived ? '<span class="text-red-600 text-sm ml-2">[Archived]</span>' : ''}
          </div>
          <div class="space-x-2">
            <button onclick="changeCategory(${index})" class="change-cat text-blue-600 hover:text-blue-800">Change Category</button>
            <button onclick="archiveBot(${index})" class="archive text-yellow-600 hover:text-yellow-800">${product.isArchived ? 'Unarchive' : 'Archive'}</button>
            <button onclick="deleteBot(${index})" class="delete text-red-600 hover:text-red-800">Delete</button>
          </div>
        </li>
      `).join("");
    }

    async function deleteBot(index) {
      if (confirm("Are you sure you want to delete this bot?")) {
        products.splice(index, 1);
        const success = await saveData();
        if (success) {
          renderBots();
          alert("Bot deleted and synced to GitHub!");
        }
      }
    }

    async function archiveBot(index) {
      products[index].isArchived = !products[index].isArchived;
      const success = await saveData();
      if (success) {
        renderBots();
        alert("Bot updated and synced to GitHub!");
      }
    }

    async function changeCategory(index) {
      const newCat = prompt("Enter new category:", products[index].category);
      if (newCat && categories.includes(newCat)) {
        products[index].category = newCat;
        const success = await saveData();
        if (success) {
          renderBots();
          alert("Category updated and synced to GitHub!");
        }
      } else if (newCat) {
        alert("Category not found! Add it in the categories section first.");
      }
    }

    document.getElementById("product-form").addEventListener("submit", async (e) => {
      e.preventDefault();
      const button = e.target.querySelector("button[type='submit']");
      button.dataset.originalText = button.textContent;
      setButtonLoading(button, true);
      const product = {
        name: document.getElementById("name").value,
        price: document.getElementById("price").value,
        desc: document.getElementById("desc").value,
        embed: document.getElementById("embed").value || "",
        category: document.getElementById("category").value,
        item: document.getElementById("item").value,
        img: document.getElementById("img").value,
        isNew: document.getElementById("isNew").checked,
        isArchived: false,
        clicks: 0
      };
      products.push(product);
      const success = await saveData();
      if (success) {
        alert("Product added and synced to GitHub!");
        e.target.reset();
        renderBots();
      }
      setButtonLoading(button, false);
    });

    document.getElementById("save-urgent").addEventListener("click", async (e) => {
      const button = e.target;
      setButtonLoading(button, true);
      settings.urgentMessage = {
        enabled: document.getElementById("urgent-toggle").checked,
        text: document.getElementById("urgent-message").value
      };
      const success = await saveData();
      if (success) {
        alert("Urgent message saved and synced to GitHub!");
      }
      setButtonLoading(button, false);
    });

    document.getElementById("save-email").addEventListener("click", async (e) => {
      const button = e.target;
      setButtonLoading(button, true);
      settings.supportEmail = document.getElementById("support-email").value;
      const success = await saveData();
      if (success) {
        alert("Support email saved and synced to GitHub!");
      }
      setButtonLoading(button, false);
    });

    document.getElementById("save-copyright").addEventListener("click", async (e) => {
      const button = e.target;
      setButtonLoading(button, true);
      settings.copyrightText = document.getElementById("copyright-text").value;
      const success = await saveData();
      if (success) {
        alert("Copyright text saved and synced to GitHub!");
      }
      setButtonLoading(button, false);
    });

    document.getElementById("save-logo").addEventListener("click", async (e) => {
      const button = e.target;
      setButtonLoading(button, true);
      settings.logoUrl = document.getElementById("logo-url").value;
      const success = await saveData();
      if (success) {
        alert("Logo URL saved and synced to GitHub!");
      }
      setButtonLoading(button, false);
    });

    document.getElementById("save-socials").addEventListener("click", async (e) => {
      const button = e.target;
      setButtonLoading(button, true);
      settings.socials = {
        tiktok: document.getElementById("tiktok").value,
        whatsapp: document.getElementById("whatsapp").value,
        call: document.getElementById("call").value,
        instagram: document.getElementById("instagram").value,
        x: document.getElementById("x").value,
        facebook: document.getElementById("facebook").value,
        youtube: document.getElementById("youtube").value
      };
      const success = await saveData();
      if (success) {
        alert("Social media links saved and synced to GitHub!");
      }
      setButtonLoading(button, false);
    });

    document.getElementById("save-payment").addEventListener("click", async (e) => {
      const button = e.target;
      setButtonLoading(button, true);
      settings.paymentGateway = {
        name: document.getElementById("payment-name").value,
        url: document.getElementById("payment-url").value || "https://kaylie-payment-site.vercel.app/"
      };
      const success = await saveData();
      if (success) {
        alert("Payment gateway saved and synced to GitHub!");
      }
      setButtonLoading(button, false);
    });

    document.getElementById("change-password").addEventListener("click", async (e) => {
      const button = e.target;
      setButtonLoading(button, true);
      const newPass = document.getElementById("new-password").value;
      const confirmPass = document.getElementById("confirm-password").value;
      if (newPass && newPass === confirmPass) {
        settings.adminPassword = newPass;
        const success = await saveData();
        if (success) {
          await fetchData(); // Refresh settings to ensure the new password is loaded
          alert("Password changed successfully and synced to GitHub! Please log in again with your new password.");
          document.getElementById("new-password").value = "";
          document.getElementById("confirm-password").value = "";
          document.getElementById("login-email").value = "";
          document.getElementById("login-password").value = "";
          loginModal.classList.remove("hidden"); // Force re-login
        }
      } else {
        alert("Passwords do not match or are empty!");
      }
      setButtonLoading(button, false);
    });

    async function initialize() {
      await fetchData();
      document.getElementById("support-email").value = settings.supportEmail;
      document.getElementById("copyright-text").value = settings.copyrightText;
      document.getElementById("logo-url").value = settings.logoUrl;
      document.getElementById("urgent-toggle").checked = settings.urgentMessage.enabled;
      document.getElementById("urgent-message").value = settings.urgentMessage.text;
      document.getElementById("tiktok").value = settings.socials.tiktok || "";
      document.getElementById("whatsapp").value = settings.socials.whatsapp || "";
      document.getElementById("call").value = settings.socials.call || "";
      document.getElementById("instagram").value = settings.socials.instagram || "";
      document.getElementById("x").value = settings.socials.x || "";
      document.getElementById("facebook").value = settings.socials.facebook || "";
      document.getElementById("youtube").value = settings.socials.youtube || "";
      document.getElementById("payment-name").value = settings.paymentGateway.name || "";
      document.getElementById("payment-url").value = settings.paymentGateway.url || "https://kaylie-payment-site.vercel.app/";
      renderCategories();
      renderCategoryList();
      renderBots();
    }

    initialize();
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'92f7dd809f966738',t:'MTc0NDUxNDgyMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
