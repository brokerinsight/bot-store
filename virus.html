<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Virus - Deriv Bot Store</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Blur everything except the login modal when it's visible */
    body:has(#login-modal:not(.hidden)) > *:not(#login-modal) {
      filter: blur(5px);
    }
  </style>
</head>
<body class="bg-gray-100">
  <!-- Admin Navbar -->
  <nav class="bg-white shadow-md sticky top-0 z-20">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex items-center">
          <h1 class="text-xl font-bold text-gray-800">Admin Panel</h1>
          <div class="ml-6 flex space-x-4 sm:space-x-8">
            <a href="#add-bot" class="nav-link text-gray-500 hover:text-gray-900 inline-flex items-center px-1 pt-1 text-sm font-medium border-b-2 border-green-500">Add Bot</a>
            <a href="#manage-bots" class="nav-link text-gray-500 hover:text-gray-900 inline-flex items-center px-1 pt-1 text-sm font-medium">Manage Bots</a>
            <a href="#settings" class="nav-link text-gray-500 hover:text-gray-900 inline-flex items-center px-1 pt-1 text-sm font-medium">Settings</a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- Add Bot Section -->
    <section id="add-bot" class="section bg-white rounded-lg shadow-md p-6 mb-8">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Add New Bot</h2>
      <form id="product-form">
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="name" class="block text-sm font-medium text-gray-700">Name</label>
            <input type="text" id="name" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="price" class="block text-sm font-medium text-gray-700">Price ($)</label>
            <input type="number" id="price" step="0.01" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div class="sm:col-span-2">
            <label for="desc" class="block text-sm font-medium text-gray-700">Description</label>
            <textarea id="desc" required class="mt-1 w-full p-2 border border-gray-300 rounded-md"></textarea>
          </div>
          <div class="sm:col-span-2">
            <label for="embed" class="block text-sm font-medium text-gray-700">Embed Link (Optional, e.g., YouTube)</label>
            <input type="url" id="embed" class="mt-1 w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., https://www.youtube.com/embed/VIDEO_ID">
          </div>
          <div>
            <label for="category" class="block text-sm font-medium text-gray-700">Category</label>
            <select id="category" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
              <!-- Populated dynamically -->
            </select>
          </div>
          <div>
            <label for="item" class="block text-sm font-medium text-gray-700">Item ID</label>
            <input type="text" id="item" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div class="sm:col-span-2">
            <label for="img" class="block text-sm font-medium text-gray-700">Image URL</label>
            <input type="url" id="img" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div class="sm:col-span-2">
            <label class="flex items-center">
              <input type="checkbox" id="isNew" class="mr-2">
              <span class="text-sm font-medium text-gray-700">Mark as New</span>
            </label>
          </div>
        </div>
        <button type="submit" class="mt-6 w-full bg-green-600 text-white py-2 rounded-md hover:bg-green-700">Add Product</button>
      </form>
    </section>

    <!-- Manage Bots Section -->
    <section id="manage-bots" class="section bg-white rounded-lg shadow-md p-6 mb-8 hidden">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Manage Bots</h2>
      <ul id="bot-list" class="space-y-4">
        <!-- Bots listed here -->
      </ul>
    </section>

    <!-- Settings Section -->
    <section id="settings" class="section bg-white rounded-lg shadow-md p-6 hidden">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Settings</h2>
      <!-- Urgent Message -->
      <div class="mb-6">
        <label class="flex items-center">
          <input type="checkbox" id="urgent-toggle" class="mr-2">
          <span class="text-sm font-medium text-gray-700">Show Urgent Message on Store</span>
        </label>
        <textarea id="urgent-message" class="mt-2 w-full p-2 border border-gray-300 rounded-md" placeholder="Enter urgent message..."></textarea>
        <button id="save-urgent" class="mt-2 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Save Message</button>
      </div>
      <!-- Support Email -->
      <div class="mb-6">
        <label for="support-email" class="block text-sm font-medium text-gray-700">Support Email</label>
        <input type="email" id="support-email" class="mt-1 w-full p-2 border border-gray-300 rounded-md" value="support@derivbotstore.com">
        <button id="save-email" class="mt-2 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Save Email</button>
      </div>
      <!-- Copyright Text -->
      <div class="mb-6">
        <label for="copyright-text" class="block text-sm font-medium text-gray-700">Footer Copyright Text</label>
        <input type="text" id="copyright-text" class="mt-1 w-full p-2 border border-gray-300 rounded-md" value="© 2025 Deriv Bot Store. All rights reserved.">
        <button id="save-copyright" class="mt-2 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Save Copyright</button>
      </div>
      <!-- Logo URL -->
      <div class="mb-6">
        <label for="logo-url" class="block text-sm font-medium text-gray-700">Logo URL (for Navbar)</label>
        <input type="url" id="logo-url" class="mt-1 w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., https://via.placeholder.com/150">
        <button id="save-logo" class="mt-2 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Save Logo</button>
      </div>
      <!-- Social Media Links -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Social Media Links</h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="tiktok" class="block text-sm font-medium text-gray-700">TikTok</label>
            <input type="url" id="tiktok" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="whatsapp" class="block text-sm font-medium text-gray-700">WhatsApp</label>
            <input type="url" id="whatsapp" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="call" class="block text-sm font-medium text-gray-700">Call</label>
            <input type="tel" id="call" class="mt-1 w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., tel:+1234567890">
          </div>
          <div>
            <label for="instagram" class="block text-sm font-medium text-gray-700">Instagram</label>
            <input type="url" id="instagram" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="x" class="block text-sm font-medium text-gray-700">X</label>
            <input type="url" id="x" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="facebook" class="block text-sm font-medium text-gray-700">Facebook</label>
            <input type="url" id="facebook" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="youtube" class="block text-sm font-medium text-gray-700">YouTube</label>
            <input type="url" id="youtube" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
        </div>
        <button id="save-socials" class="mt-4 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Save Socials</button>
      </div>
      <!-- Payment Gateway -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Payment Gateway</h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="payment-name" class="block text-sm font-medium text-gray-700">Payment Gateway Name</label>
            <input type="text" id="payment-name" class="mt-1 w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., Crypto">
          </div>
          <div>
            <label for="payment-url" class="block text-sm font-medium text-gray-700">Payment Gateway URL</label>
            <input type="url" id="payment-url" class="mt-1 w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., https://crypto-payment.com">
          </div>
        </div>
        <button id="save-payment" class="mt-4 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Save Payment Gateway</button>
      </div>
      <!-- Change Password -->
      <div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Change Admin Password</h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="new-password" class="block text-sm font-medium text-gray-700">New Password</label>
            <input type="password" id="new-password" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
          <div>
            <label for="confirm-password" class="block text-sm font-medium text-gray-700">Confirm Password</label>
            <input type="password" id="confirm-password" class="mt-1 w-full p-2 border border-gray-300 rounded-md">
          </div>
        </div>
        <button id="change-password" class="mt-4 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">Change Password</button>
      </div>
    </section>
  </main>

  <!-- Login Modal -->
  <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg p-6 max-w-sm w-full">
      <h3 class="text-xl font-bold text-gray-900 mb-4">Admin Login</h3>
      <div class="mb-4">
        <label for="login-email" class="block text-sm font-medium text-gray-700">Email</label>
        <input type="email" id="login-email" class="mt-1 w-full p-2 border border-gray-300 rounded-md" required>
      </div>
      <div class="mb-4 relative">
        <label for="login-password" class="block text-sm font-medium text-gray-700">Password</label>
        <input type="password" id="login-password" class="mt-1 w-full p-2 border border-gray-300 rounded-md" required>
        <button type="button" id="toggle-password" class="absolute right-2 top-9 text-gray-500">Show</button>
      </div>
      <button id="login-submit" class="w-full bg-green-600 text-white py-2 rounded-md hover:bg-green-700">Login</button>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    // Load data
    let products = JSON.parse(localStorage.getItem("products")) || [];
    let categories = JSON.parse(localStorage.getItem("categories")) || ["Digit Bots", "Over/Under", "Rise/Fall"];
    let settings = JSON.parse(localStorage.getItem("settings")) || {
      adminEmail: "martinke444@gmail.com",
      adminPassword: "#0719529802#0710160851#Pn",
      supportEmail: "support@derivbotstore.com",
      copyrightText: "© 2025 Deriv Bot Store. All rights reserved.",
      logoUrl: "",
      socials: { tiktok: "", whatsapp: "", call: "", instagram: "", x: "", facebook: "", youtube: "" },
      urgentMessage: { enabled: false, text: "" },
      paymentGateway: { name: "", url: "https://kaylie-payment-site.vercel.app/" }
    };

    // Save data
    function saveData() {
      localStorage.setItem("products", JSON.stringify(products));
      localStorage.setItem("categories", JSON.stringify(categories));
      localStorage.setItem("settings", JSON.stringify(settings));
    }

    // Admin login
    const loginModal = document.getElementById("login-modal");
    const loginPassword = document.getElementById("login-password");
    const togglePassword = document.getElementById("toggle-password");
    togglePassword.addEventListener("click", () => {
      const type = loginPassword.type === "password" ? "text" : "password";
      loginPassword.type = type;
      togglePassword.textContent = type === "password" ? "Show" : "Hide";
    });
    document.getElementById("login-submit").addEventListener("click", () => {
      const email = document.getElementById("login-email").value;
      const password = document.getElementById("login-password").value;
      if (email === settings.adminEmail && password === settings.adminPassword) {
        loginModal.classList.add("hidden");
      } else {
        alert("Invalid email or password!");
      }
    });

    // Navigation
    const sections = document.querySelectorAll(".section");
    document.querySelectorAll(".nav-link").forEach(link => {
      link.addEventListener("click", (e) => {
        e.preventDefault();
        const target = link.getAttribute("href").substring(1);
        sections.forEach(section => section.classList.add("hidden"));
        document.getElementById(target).classList.remove("hidden");
        document.querySelectorAll(".nav-link").forEach(l => l.classList.remove("border-b-2", "border-green-500"));
        link.classList.add("border-b-2", "border-green-500");
      });
    });

    // Populate category select
    function renderCategories() {
      const select = document.getElementById("category");
      select.innerHTML = "";
      categories.forEach(cat => {
        const option = document.createElement("option");
        option.value = cat;
        option.textContent = cat;
        select.appendChild(option);
      });
    }

    // Render bots in manage section
    function renderBots() {
      const botList = document.getElementById("bot-list");
      botList.innerHTML = products.map((product, index) => `
        <li class="p-4 bg-gray-50 rounded flex justify-between items-center">
          <div>
            <span class="font-semibold">${product.name}</span> - $${product.price} (${product.category})
            ${product.isArchived ? '<span class="text-red-600 text-sm ml-2">[Archived]</span>' : ''}
          </div>
          <div class="space-x-2">
            <button onclick="changeCategory(${index})" class="change-cat text-blue-600 hover:text-blue-800">Change Category</button>
            <button onclick="archiveBot(${index})" class="archive text-yellow-600 hover:text-yellow-800">${product.isArchived ? 'Unarchive' : 'Archive'}</button>
            <button onclick="deleteBot(${index})" class="delete text-red-600 hover:text-red-800">Delete</button>
          </div>
        </li>
      `).join("");
    }

    // Delete bot
    function deleteBot(index) {
      if (confirm("Are you sure you want to delete this bot?")) {
        products.splice(index, 1);
        saveData();
        renderBots();
      }
    }

    // Archive bot
    function archiveBot(index) {
      products[index].isArchived = !products[index].isArchived;
      saveData();
      renderBots();
    }

    // Change category
    function changeCategory(index) {
      const newCat = prompt("Enter new category:", products[index].category);
      if (newCat && categories.includes(newCat)) {
        products[index].category = newCat;
        saveData();
        renderBots();
      } else if (newCat) {
        alert("Category not found! Add it in the categories section first.");
      }
    }

    // Add product
    document.getElementById("product-form").addEventListener("submit", (e) => {
      e.preventDefault();
      const product = {
        name: document.getElementById("name").value,
        price: document.getElementById("price").value,
        desc: document.getElementById("desc").value,
        embed: document.getElementById("embed").value || "",
        category: document.getElementById("category").value,
        item: document.getElementById("item").value,
        img: document.getElementById("img").value,
        isNew: document.getElementById("isNew").checked,
        isArchived: false,
        clicks: 0
      };
      products.push(product);
      saveData();
      alert("Product added!");
      e.target.reset();
      renderBots();
    });

    // Settings: Urgent Message
    document.getElementById("save-urgent").addEventListener("click", () => {
      settings.urgentMessage = {
        enabled: document.getElementById("urgent-toggle").checked,
        text: document.getElementById("urgent-message").value
      };
      saveData();
      alert("Urgent message saved!");
    });

    // Settings: Support Email
    document.getElementById("save-email").addEventListener("click", () => {
      settings.supportEmail = document.getElementById("support-email").value;
      saveData();
      alert("Support email saved!");
    });

    // Settings: Copyright Text
    document.getElementById("save-copyright").addEventListener("click", () => {
      settings.copyrightText = document.getElementById("copyright-text").value;
      saveData();
      alert("Copyright text saved!");
    });

    // Settings: Logo URL
    document.getElementById("save-logo").addEventListener("click", () => {
      settings.logoUrl = document.getElementById("logo-url").value;
      saveData();
      alert("Logo URL saved!");
    });

    // Settings: Social Media Links
    document.getElementById("save-socials").addEventListener("click", () => {
      settings.socials = {
        tiktok: document.getElementById("tiktok").value,
        whatsapp: document.getElementById("whatsapp").value,
        call: document.getElementById("call").value,
        instagram: document.getElementById("instagram").value,
        x: document.getElementById("x").value,
        facebook: document.getElementById("facebook").value,
        youtube: document.getElementById("youtube").value
      };
      saveData();
      alert("Social media links saved!");
    });

    // Settings: Payment Gateway
    document.getElementById("save-payment").addEventListener("click", () => {
      settings.paymentGateway = {
        name: document.getElementById("payment-name").value,
        url: document.getElementById("payment-url").value || "https://kaylie-payment-site.vercel.app/"
      };
      saveData();
      alert("Payment gateway saved!");
    });

    // Settings: Change Password
    document.getElementById("change-password").addEventListener("click", () => {
      const newPass = document.getElementById("new-password").value;
      const confirmPass = document.getElementById("confirm-password").value;
      if (newPass && newPass === confirmPass) {
        settings.adminPassword = newPass;
        saveData();
        alert("Password changed successfully!");
        document.getElementById("new-password").value = "";
        document.getElementById("confirm-password").value = "";
      } else {
        alert("Passwords do not match or are empty!");
      }
    });

    // Initialize settings fields
    document.getElementById("support-email").value = settings.supportEmail;
    document.getElementById("copyright-text").value = settings.copyrightText;
    document.getElementById("logo-url").value = settings.logoUrl;
    document.getElementById("urgent-toggle").checked = settings.urgentMessage.enabled;
    document.getElementById("urgent-message").value = settings.urgentMessage.text;
    document.getElementById("tiktok").value = settings.socials.tiktok || "";
    document.getElementById("whatsapp").value = settings.socials.whatsapp || "";
    document.getElementById("call").value = settings.socials.call || "";
    document.getElementById("instagram").value = settings.socials.instagram || "";
    document.getElementById("x").value = settings.socials.x || "";
    document.getElementById("facebook").value = settings.socials.facebook || "";
    document.getElementById("youtube").value = settings.socials.youtube || "";
    document.getElementById("payment-name").value = settings.paymentGateway.name || "";
    document.getElementById("payment-url").value = settings.paymentGateway.url || "https://kaylie-payment-site.vercel.app/";

    // Initialize
    renderCategories();
    renderBots();
  </script>
</body>
</html>
